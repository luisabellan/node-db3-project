"use strict";var express=require("express"),Schemes=require("./scheme-model"),router=express.Router();router.get("/",function(e,s){Schemes.find().then(function(e){s.json(e)}).catch(function(e){s.status(500).json({message:"Failed to get schemes"})})}),router.get("/:id",function(e,s){var t=e.params.id;Schemes.findById(t).then(function(e){e?s.json(e):s.status(404).json({message:"Could not find scheme with given id."})}).catch(function(e){s.status(500).json({message:"Failed to get schemes"})})}),router.get("/:id/steps",function(e,s){var t=e.params.id;Schemes.findSteps(t).then(function(e){e.length?s.json(e):s.status(404).json({message:"Could not find steps for given scheme"})}).catch(function(e){s.status(500).json({message:"Failed to get steps"})})}),router.post("/",function(e,s){var t=e.body;Schemes.add(t).then(function(e){s.status(201).json(e)}).catch(function(e){s.status(500).json({message:"Failed to create new scheme"})})}),router.post("/:id/steps",function(e,s){var t=e.body,n=e.params.id;Schemes.findById(n).then(function(e){e?Schemes.addStep(t,n).then(function(e){s.status(201).json(e)}):s.status(404).json({message:"Could not find scheme with given id."})}).catch(function(e){s.status(500).json({message:"Failed to create new step"})})}),router.put("/:id",function(e,s){var t=e.params.id,n=e.body;Schemes.findById(t).then(function(e){e?Schemes.update(n,t).then(function(e){s.json(e)}):s.status(404).json({message:"Could not find scheme with given id"})}).catch(function(e){s.status(500).json({message:"Failed to update scheme"})})}),router.delete("/:id",function(e,s){var t=e.params.id;Schemes.remove(t).then(function(e){e?s.json({removed:e}):s.status(404).json({message:"Could not find scheme with given id"})}).catch(function(e){s.status(500).json({message:"Failed to delete scheme"})})}),module.exports=router;